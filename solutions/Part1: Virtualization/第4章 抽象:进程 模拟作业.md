

### 1. 

`./process-run.py -l 5:100,5:100`

有两个进程在 CPU 上运行，每个进程有 5 条指令，全部是 CPU 指令，没有 I/O 操作。

由于是纯 CPU 任务，且没有发生 I/O，CPU 始终处于忙碌状态。PID 0 进程先执行完 5 条指令，然后 PID 1 进程再执行完 5 条指令。总共耗时 10 个时间单位，CPU 使用率为 100%。

```
./process-run.py -l 5:100,5:100 -c -p
Time        PID: 0        PID: 1           CPU           I/Os
  1        RUN:cpu         READY             1          
  2        RUN:cpu         READY             1          
  3        RUN:cpu         READY             1          
  4        RUN:cpu         READY             1          
  5        RUN:cpu         READY             1          
  6           DONE       RUN:cpu             1          
  7           DONE       RUN:cpu             1          
  8           DONE       RUN:cpu             1          
  9           DONE       RUN:cpu             1          
 10           DONE       RUN:cpu             1          

Stats: Total Time 10
Stats: CPU Busy 10 (100.00%)
Stats: I/O Busy  0 (0.00%)
```



### 2.

`./process-run.py -l 4:100,1:0`

未指定的情况下默认I/O时间是5个单位

也就是需要的时间为4+ 1 + 5(I/O时间)+  1 ，其他的都是cpu时间 一共11 

进程1的时间 4  进程2的时间 1+5+1 = 7

```
./process-run.py -l 4:100,1:0 -c -p
Time        PID: 0        PID: 1           CPU           I/Os
  1        RUN:cpu         READY             1          
  2        RUN:cpu         READY             1          
  3        RUN:cpu         READY             1          
  4        RUN:cpu         READY             1          
  5           DONE        RUN:I/O             1          
  6           DONE       BLOCKED                           1
  7           DONE       BLOCKED                           1
  8           DONE       BLOCKED                           1
  9           DONE       BLOCKED                           1
 10           DONE       BLOCKED                           1
 11*          DONE   RUN:I/O_done             1          

Stats: Total Time 11
Stats: CPU Busy 6 (54.55%)
Stats: I/O Busy  5 (45.45%)
```



### 3.

`./process-run.py -l 1:0,4:100`

首先proc0执行I/O，然后proc0进入block状态，切换到proc1 执行4条cpu指令

也就是需要的时间为1 + 5 +1 其中覆盖了proc1的4个时间

cpu运行的时间1:启动I/O  2 3 4 5 proc1执行指令 7 I/O结束

I/O时间:proc0的默认5个时间片

```
./process-run.py -l 1:0,4:100 -c -p
Time        PID: 0        PID: 1           CPU           I/Os
  1         RUN:I/O         READY             1          
  2        BLOCKED       RUN:cpu             1             1
  3        BLOCKED       RUN:cpu             1             1
  4        BLOCKED       RUN:cpu             1             1
  5        BLOCKED       RUN:cpu             1             1
  6        BLOCKED          DONE                           1
  7*   RUN:I/O_done          DONE             1          

Stats: Total Time 7
Stats: CPU Busy 6 (85.71%)
Stats: I/O Busy  5 (71.43%)
```





### 5.

```sh
#当前进程完全结束的时候才会切换到另一个进程
./process-run.py -l 1:0,4:100 -c -S SWITCH_ON_END -c -p

#如果一个进程发起了I/O请求 系统立刻中断他 切换到其他的READY队列的进程
./process-run.py -l 1:0,4:100 -c -S SWITCH_ON_I/O -c -p
```





### 6.

`./process-run.py -l 3:0,5:100,5:100,5:100 -S SWITCH_ON_I/O -I I/O_RUN_LATER -c -p`

**`-I I/O_RUN_LATER`**: 这个参数决定了**I/O 完成后的行为**。它意味着当一个进程的 I/O 完成后，它不会立即获得 CPU，而是被放入就绪队列，等待下一次被调度。

也就是这里的proc0会发起I/O请求，然后被block切换到proc1，开始执行，在时间点6 porc0的I/O请求执行完毕，但是并不会插队到它继续执行，而是根据 `I/O_RUN_LATER` 规则，它不会抢占 CPU，而是进入**就绪队列**，排在进程 1、2、3 的后面。在时间片17可以看见结束了RUN:I/O_done ，18开始新的I/O请求

```sh
./process-run.py -l 3:0,5:100,5:100,5:100 -S SWITCH_ON_I/O -I I/O_RUN_LATER -c -p
Time        PID: 0        PID: 1        PID: 2        PID: 3           CPU           I/Os
  1         RUN:I/O         READY         READY         READY             1          
  2        BLOCKED       RUN:cpu         READY         READY             1             1
  3        BLOCKED       RUN:cpu         READY         READY             1             1
  4        BLOCKED       RUN:cpu         READY         READY             1             1
  5        BLOCKED       RUN:cpu         READY         READY             1             1
  6        BLOCKED       RUN:cpu         READY         READY             1             1
  7*         READY          DONE       RUN:cpu         READY             1          
  8          READY          DONE       RUN:cpu         READY             1          
  9          READY          DONE       RUN:cpu         READY             1          
 10          READY          DONE       RUN:cpu         READY             1          
 11          READY          DONE       RUN:cpu         READY             1          
 12          READY          DONE          DONE       RUN:cpu             1          
 13          READY          DONE          DONE       RUN:cpu             1          
 14          READY          DONE          DONE       RUN:cpu             1          
 15          READY          DONE          DONE       RUN:cpu             1          
 16          READY          DONE          DONE       RUN:cpu             1          
 17    RUN:I/O_done          DONE          DONE          DONE             1          
 18         RUN:I/O          DONE          DONE          DONE             1          
 19        BLOCKED          DONE          DONE          DONE                           1
 20        BLOCKED          DONE          DONE          DONE                           1
 21        BLOCKED          DONE          DONE          DONE                           1
 22        BLOCKED          DONE          DONE          DONE                           1
 23        BLOCKED          DONE          DONE          DONE                           1
 24*   RUN:I/O_done          DONE          DONE          DONE             1          
 25         RUN:I/O          DONE          DONE          DONE             1          
 26        BLOCKED          DONE          DONE          DONE                           1
 27        BLOCKED          DONE          DONE          DONE                           1
 28        BLOCKED          DONE          DONE          DONE                           1
 29        BLOCKED          DONE          DONE          DONE                           1
 30        BLOCKED          DONE          DONE          DONE                           1
 31*   RUN:I/O_done          DONE          DONE          DONE             1          

Stats: Total Time 31
Stats: CPU Busy 21 (67.74%)
Stats: I/O Busy  15 (48.39%)
```



### 7。

```
./process-run.py -l 3:0,5:100,5:100,5:100 -S SWITCH_ON_I/O -I I/O_RUN_IMMEDIATE -c -p
```

`-I I/O_RUN_IMMEDIATE`    立刻插队执行I/O

运行完成I/O的进程可能有两种操作

1.继续请求I/O

2.进行cpu指令

如果是1，那么可以和之前一样，请求I/O后切换到READY的进程 执行其他的操作

如果是2，那么就和正常的 CPU 密集型任务一样

```sh
./process-run.py -l 3:0,5:100,5:100,5:100 -S SWITCH_ON_I/O -I I/O_RUN_IMMEDIATE -c -p
Time        PID: 0        PID: 1        PID: 2        PID: 3           CPU           I/Os
  1         RUN:I/O         READY         READY         READY             1          
  2        BLOCKED       RUN:cpu         READY         READY             1             1
  3        BLOCKED       RUN:cpu         READY         READY             1             1
  4        BLOCKED       RUN:cpu         READY         READY             1             1
  5        BLOCKED       RUN:cpu         READY         READY             1             1
  6        BLOCKED       RUN:cpu         READY         READY             1             1
  7*   RUN:I/O_done          DONE         READY         READY             1          
  8         RUN:I/O          DONE         READY         READY             1          
  9        BLOCKED          DONE       RUN:cpu         READY             1             1
 10        BLOCKED          DONE       RUN:cpu         READY             1             1
 11        BLOCKED          DONE       RUN:cpu         READY             1             1
 12        BLOCKED          DONE       RUN:cpu         READY             1             1
 13        BLOCKED          DONE       RUN:cpu         READY             1             1
 14*   RUN:I/O_done          DONE          DONE         READY             1          
 15         RUN:I/O          DONE          DONE         READY             1          
 16        BLOCKED          DONE          DONE       RUN:cpu             1           sd 1
 17        BLOCKED          DONE          DONE       RUN:cpu             1             1
 18        BLOCKED          DONE          DONE       RUN:cpu             1             1
 19        BLOCKED          DONE          DONE       RUN:cpu             1             1
 20        BLOCKED          DONE          DONE       RUN:cpu             1             1
 21*   RUN:I/O_done          DONE          DONE          DONE             1          

Stats: Total Time 21
Stats: CPU Busy 21 (100.00%)
Stats: I/O Busy  15 (71.43%)
```

